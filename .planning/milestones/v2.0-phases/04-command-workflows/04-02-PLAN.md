---
phase: 04-command-workflows
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [commands/status/COMMAND.md, .claude-plugin/plugin.json]
autonomous: true

must_haves:
  truths:
    - "/status shows available commands and suggested next action for each site"
    - "Plugin manifest reflects /diagnose as implemented and /audit removed"
    - "Plugin version is bumped to 2.0.0 marking project completion"
    - "commands/audit/ directory is removed since /audit merged into /diagnose"
  artifacts:
    - path: "commands/status/COMMAND.md"
      provides: "Enhanced /status with available commands and next action suggestions"
      min_lines: 400
    - path: ".claude-plugin/plugin.json"
      provides: "Final plugin manifest v2.0.0"
      contains: "2.0.0"
  key_links:
    - from: "commands/status/COMMAND.md"
      to: "memory/{site-name}/latest.md"
      via: "Reads latest report for suggested next action"
      pattern: "memory.*latest\\.md"
    - from: ".claude-plugin/plugin.json"
      to: "commands/diagnose/COMMAND.md"
      via: "Registers /diagnose as implemented command"
      pattern: "diagnose.*implemented"
---

<objective>
Enhance /status with minor additions (available commands, suggested next action per site) and finalize the plugin manifest for project completion -- removing the /audit placeholder, marking /diagnose as implemented, and bumping to v2.0.0.

Purpose: Polish the existing /status command and close out the plugin manifest to reflect the completed state of the project.
Output: Updated commands/status/COMMAND.md, updated .claude-plugin/plugin.json, removed commands/audit/ directory
</objective>

<execution_context>
@/Users/robertli/.claude/get-shit-done/workflows/execute-plan.md
@/Users/robertli/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-command-workflows/04-CONTEXT.md
@commands/status/COMMAND.md
@.claude-plugin/plugin.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance /status with available commands and suggested next actions</name>
  <files>commands/status/COMMAND.md</files>
  <action>
Read the existing commands/status/COMMAND.md and add two enhancements to the default listing behavior (Section 1):

**Enhancement A: Available Commands Footer**
After the existing site listing output (after the "Reconnect:" hint), add an "Available Commands" section that shows:
```
## Available Commands
- /connect [site-name] -- Connect to a WordPress site
- /diagnose [mode] [on site-name] -- Run diagnostic scan (modes: full, security only, code only)
- /status -- View connected sites and scan results
```
This should appear at the bottom of every /status invocation, below all site listings. Keep it concise -- 3 lines, not a full help page.

**Enhancement B: Suggested Next Action Per Site**
In the per-site display loop (where it already shows health grade and findings), add a "Suggested action" line after the diagnostic summary:

Logic for suggested action:
1. If no report exists (memory/{site-name}/latest.md missing): "Run /diagnose to analyze this site"
2. If report exists, check scan age:
   - Extract date from report's `**Date:**` line
   - If older than 7 days: "Re-scan recommended (last scan {N} days ago)"
3. If report has critical findings (Critical count > 0): "Fix {N} critical issues, then re-scan"
4. If report is healthy (no critical, few warnings): "Healthy -- next scan recommended in {N} days"

Add the suggested action as a new line: `- **Next action:** {suggestion}`

This goes right after the existing `- **Top Issues:**` block (or after `- **Diagnostics:** No scan results yet` for sites without reports).

Do NOT restructure or rewrite the existing /status logic. Only ADD these two enhancements to the existing file. Preserve all existing functionality exactly as-is.
  </action>
  <verify>
Read commands/status/COMMAND.md and verify:
1. "Available Commands" section exists near bottom of default listing
2. "Next action" line appears in per-site diagnostic summary
3. All existing /status functionality preserved (list, remove, default, rename)
4. File is 400+ lines (was 428, should be ~450+ with additions)
  </verify>
  <done>
/status displays available commands footer and suggested next action per site. Existing remove/default/rename functionality unchanged.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update plugin manifest and remove /audit placeholder</name>
  <files>.claude-plugin/plugin.json</files>
  <action>
Two changes:

**A: Update .claude-plugin/plugin.json:**
1. Bump version from "1.2.0" to "2.0.0" (project completion milestone per Claude's discretion -- all 4 phases complete)
2. Update commands.diagnose:
   - description: "Run diagnostic suite with full, security-only, or code-only modes on connected WordPress sites"
   - status: "implemented"
3. Remove commands.audit entirely (per user decision: /audit is NOT a separate command, it is /diagnose in security-only mode)
4. Leave all other entries (connect, status, all skills) unchanged

**B: Remove commands/audit/ directory:**
Run: `rm -rf commands/audit/`
This directory was a placeholder from Phase 1 and is no longer needed since /audit merged into /diagnose.
  </action>
  <verify>
1. Read .claude-plugin/plugin.json: version is "2.0.0", diagnose status is "implemented", no "audit" key in commands
2. Verify commands/audit/ directory does not exist: `ls commands/audit/` should fail
3. Verify commands/diagnose/ directory still exists
  </verify>
  <done>
Plugin manifest at v2.0.0 with /diagnose implemented and /audit removed. Audit directory cleaned up.
  </done>
</task>

</tasks>

<verification>
- commands/status/COMMAND.md has available commands section and suggested next action
- .claude-plugin/plugin.json version is 2.0.0
- .claude-plugin/plugin.json has diagnose.status = "implemented"
- .claude-plugin/plugin.json has no "audit" command entry
- commands/audit/ directory does not exist
- commands/diagnose/ directory exists (not accidentally deleted)
</verification>

<success_criteria>
/status shows available commands and per-site next action suggestions. Plugin manifest reflects completed project state at v2.0.0 with /diagnose implemented and /audit removed.
</success_criteria>

<output>
After completion, create `.planning/phases/04-command-workflows/04-02-SUMMARY.md`
</output>
